<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Socket.IO Client</title>
    </head>
    <body>
        <h3>Socket.IO Test Client</h3>

        <div>
            <input id="msg" placeholder="message" />
            <button id="send">Send</button>
            <button id="shout">Shout</button>
        </div>

        <div style="margin-top: 12px">
            <input id="room" placeholder="room name" />
            <button id="join">Join Room</button>
            <button id="leave">Leave Room</button>
            <button id="sendRoom">Send to Room</button>
        </div>

        <ul id="log"></ul>

        <script src="/socket.io/socket.io.js"></script>
        <script>
            const socket = io(); // connects to same host (http://localhost:3000)

            function addLog(text) {
                const li = document.createElement("li");
                li.textContent = text;
                document.getElementById("log").appendChild(li);
            }

            socket.on("connect", () => addLog("connected: " + socket.id));
            socket.on("welcome", (d) =>
                addLog("welcome: " + JSON.stringify(d))
            );
            socket.on("message", (m) =>
                addLog("message: " + JSON.stringify(m))
            );
            socket.on("shout", (m) => addLog("shout: " + JSON.stringify(m)));
            socket.on("system", (m) => addLog("system: " + m));
            socket.on("roomMessage", (m) =>
                addLog("roomMessage: " + JSON.stringify(m))
            );
            socket.on("privateMessage", (m) =>
                addLog("private: " + JSON.stringify(m))
            );
            socket.on("userLeft", (m) =>
                addLog("userLeft: " + JSON.stringify(m))
            );

            document.getElementById("send").onclick = () => {
                const t = document.getElementById("msg").value;
                socket.emit("message", t);
            };
            document.getElementById("shout").onclick = () => {
                const t = document.getElementById("msg").value;
                socket.emit("shout", t);
            };
            document.getElementById("join").onclick = () => {
                const r = document.getElementById("room").value;
                socket.emit("joinRoom", r);
            };
            document.getElementById("leave").onclick = () => {
                const r = document.getElementById("room").value;
                socket.emit("leaveRoom", r);
            };
            document.getElementById("sendRoom").onclick = () => {
                const r = document.getElementById("room").value;
                const t = document.getElementById("msg").value;
                socket.emit("roomMessage", { room: r, text: t });
            };

            // ask server for an ack
            socket.emit("order", { item: "apple", qty: 2 }, (res) => {
                addLog("order ack: " + JSON.stringify(res));
            });
        </script>
    </body>
</html>
